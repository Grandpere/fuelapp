{% set redirect = redirectUrl|default(path('ui_receipt_index')) %}
{% set visibleColumns = visibleColumns|default([
    'id',
    'issued_at',
    'station_name',
    'station_street_name',
    'station_postal_code',
    'station_city',
    'fuel_type',
    'quantity_milli_liters',
    'unit_price_deci_cents_per_liter',
    'vat_rate_percent',
    'total_cents',
    'vat_amount_cents'
]) %}
<tr id="receipt-row-{{ receipt.id }}" class="table-row" style="cursor:pointer;" onclick="window.location.href='{{ path('ui_receipt_show', {id: receipt.id}) }}'">
    {% if 'id' in visibleColumns %}<td>{{ receipt.id }}</td>{% endif %}
    {% if 'issued_at' in visibleColumns %}<td>{{ receipt.issuedAt|date('d/m/Y H:i') }}</td>{% endif %}
    {% if 'station_name' in visibleColumns %}<td>{{ receipt.stationName ?: '-' }}</td>{% endif %}
    {% if 'station_street_name' in visibleColumns %}<td>{{ receipt.stationStreetName ?: '-' }}</td>{% endif %}
    {% if 'station_postal_code' in visibleColumns %}<td>{{ receipt.stationPostalCode ?: '-' }}</td>{% endif %}
    {% if 'station_city' in visibleColumns %}<td>{{ receipt.stationCity ?: '-' }}</td>{% endif %}
    {% if 'fuel_type' in visibleColumns %}
        <td>
            {% if receipt.fuelType %}
                <span class="pill pill-energy">{{ receipt.fuelType|upper }}</span>
            {% else %}
                -
            {% endif %}
        </td>
    {% endif %}
    {% if 'quantity_milli_liters' in visibleColumns %}<td style="text-align:right;">{{ receipt.quantityMilliLiters is not null ? (receipt.quantityMilliLiters / 1000)|number_format(3, ',', ' ') ~ ' L' : '-' }}</td>{% endif %}
    {% if 'unit_price_deci_cents_per_liter' in visibleColumns %}<td style="text-align:right;">{{ receipt.unitPriceDeciCentsPerLiter is not null ? (receipt.unitPriceDeciCentsPerLiter / 1000)|number_format(3, ',', ' ') ~ ' €/L' : '-' }}</td>{% endif %}
    {% if 'vat_rate_percent' in visibleColumns %}<td style="text-align:right;">{{ receipt.vatRatePercent is not null ? receipt.vatRatePercent ~ '%' : '-' }}</td>{% endif %}
    {% if 'total_cents' in visibleColumns %}<td style="text-align:right; font-weight:700;">{{ (receipt.totalCents / 100)|number_format(2, ',', ' ') }} €</td>{% endif %}
    {% if 'vat_amount_cents' in visibleColumns %}<td style="text-align:right;">{{ (receipt.vatAmountCents / 100)|number_format(2, ',', ' ') }} €</td>{% endif %}
    <td style="text-align:right;">
        <div style="display:inline-flex; gap:0.4rem; align-items:center;" onclick="event.stopPropagation();">
            <a class="btn btn-secondary" href="{{ path('ui_receipt_show', {id: receipt.id}) }}" style="padding:0.35rem 0.7rem; font-size:0.8rem;">View</a>
            <form method="post" action="{{ path('ui_receipt_delete', {id: receipt.id}) }}" onsubmit="return confirm('Delete this receipt?');" style="display:inline;">
                <input type="hidden" name="_token" value="{{ csrf_token('delete_receipt_' ~ receipt.id) }}">
                <input type="hidden" name="_redirect" value="{{ redirect }}">
                <button class="btn btn-danger" type="submit" style="padding:0.35rem 0.7rem; font-size:0.8rem;">Delete</button>
            </form>
        </div>
    </td>
</tr>
