{% extends 'base.html.twig' %}

{% block title %}New Receipt{% endblock %}

{% block body %}
    <main style="max-width: 760px; margin: 2rem auto; padding: 0 1rem;">
        <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h1 style="margin: 0;">Add receipt</h1>
            <a href="{{ path('ui_receipt_index') }}" style="text-decoration: none; color: #444;">Back to list</a>
        </header>

        {% if errors is not empty %}
            <div style="margin-bottom: 1rem; padding: 0.75rem 1rem; border: 1px solid #842029; background: #f8d7da; color: #842029;">
                <ul style="margin: 0; padding-left: 1.2rem;">
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <form method="post" action="{{ path('ui_receipt_new') }}" style="display: grid; gap: 1rem;">
            <input type="hidden" name="_token" value="{{ csrfToken }}">

            <label>
                Date
                <input type="datetime-local" name="issuedAt" value="{{ formData.issuedAt }}" required style="width: 100%; padding: 0.5rem;">
            </label>

            <fieldset style="border: 1px solid #ddd; padding: 1rem;">
                <legend>Fuel line</legend>
                <div style="display: grid; gap: 1rem; grid-template-columns: repeat(2, minmax(0, 1fr));">
                    <label>
                        Fuel type
                        <select name="fuelType" style="width: 100%; padding: 0.5rem;">
                            {% for fuelType in fuelTypes %}
                                <option value="{{ fuelType }}" {% if formData.fuelType == fuelType %}selected{% endif %}>{{ fuelType|upper }}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label>
                        Quantity (mL)
                        <input type="number" min="1" step="1" name="quantityMilliLiters" value="{{ formData.quantityMilliLiters }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        Unit price (cents/L)
                        <input type="number" min="0" step="1" name="unitPriceCentsPerLiter" value="{{ formData.unitPriceCentsPerLiter }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        VAT (%)
                        <input type="number" min="0" max="100" step="1" name="vatRatePercent" value="{{ formData.vatRatePercent }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                </div>
            </fieldset>

            <fieldset style="border: 1px solid #ddd; padding: 1rem;">
                <legend>Station</legend>
                <div style="display: grid; gap: 1rem; grid-template-columns: repeat(2, minmax(0, 1fr));">
                    <label>
                        Name
                        <input type="text" name="stationName" value="{{ formData.stationName }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        Street name
                        <input type="text" name="stationStreetName" value="{{ formData.stationStreetName }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        Postal code
                        <input type="text" name="stationPostalCode" value="{{ formData.stationPostalCode }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        City
                        <input type="text" name="stationCity" value="{{ formData.stationCity }}" required style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        Latitude (micro-degrees, optional)
                        <input type="number" name="latitudeMicroDegrees" value="{{ formData.latitudeMicroDegrees }}" style="width: 100%; padding: 0.5rem;">
                    </label>
                    <label>
                        Longitude (micro-degrees, optional)
                        <input type="number" name="longitudeMicroDegrees" value="{{ formData.longitudeMicroDegrees }}" style="width: 100%; padding: 0.5rem;">
                    </label>
                </div>
            </fieldset>

            <button type="submit" style="padding: 0.7rem 1rem; border: 1px solid #111; border-radius: 8px; background: #111; color: #fff;">
                Save receipt
            </button>
        </form>
    </main>
{% endblock %}
